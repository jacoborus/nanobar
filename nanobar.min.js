(function(root,factory){if(typeof exports==="object"){factory(exports)}else if(typeof define==="function"&&define.amd){define(["exports"],factory)}else{factory(root)}})(this,function(exports){exports.Nanobar=function(){"use strict";var cssCont={width:"100%",height:"4px",zIndex:9999,top:"0"};var cssBar={width:0,height:"100%",clear:"both",transition:"height .3s"};function addCss(el,css){var i;for(i in css){el.style[i]=css[i]}el.style.float="left"}function move(bar){var dist=bar.width-bar.here;if(dist<.1&&dist>-.1){place(bar,bar.here);bar.moving=false;if(bar.width===100){bar.el.style.height=0;setTimeout(function(){bar.cont.el.removeChild(bar.el);bar.cont.bars.splice(bar.cont.bars.indexOf(bar),1)},300)}}else{place(bar,bar.width-dist/4);setTimeout(function(){bar.go()},16)}}function place(bar,num){bar.width=num;bar.el.style.width=bar.width+"%"}function createBar(cont){var el=document.createElement("div");el.style.backgroundColor=cont.opts.bg;addCss(el,cssBar);cont.el.appendChild(el);var bar={el:el,width:0,here:0,moving:false,cont:cont,go:function(num){if(num){bar.here=num;if(!bar.moving){bar.moving=true;move(bar)}}else if(bar.moving){move(bar)}}};return bar}function init(cont){var bar=createBar(cont);cont.bars.unshift(bar)}function Nanobar(opts){opts||(opts={});opts.bg=opts.bg||"#000";var bars=[],el=document.createElement("div");if(opts.height&&parseInt(opts.height,10)>0){cssCont.height=opts.height}addCss(el,cssCont);if(opts.id){el.id=opts.id}el.style.position=!opts.target?"fixed":"relative";if(!opts.target){document.getElementsByTagName("body")[0].appendChild(el)}else{opts.target.insertBefore(el,opts.target.firstChild)}var nanobar={el:el,bars:bars,opts:opts,go:function(p){bars[0].go(p);if(p===100){init(nanobar)}}};init(nanobar);return nanobar}return Nanobar}();return exports.Nanobar});